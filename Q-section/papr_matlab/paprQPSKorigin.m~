clc;
clear;

%ccdf = comm.CCDF('AveragePowerOutputPort',true,'PeakPowerOutputPort',true);
block=20000;
Q = 4;


for i = 1: block
    message = randi([0 1],512,1);
    message = nrPolarEncode(message,1024,10,false);
    qamTxSig = qammod(message,4,'InputType','bit','UnitAveragePower',true);
    TTT = ifft(qamTxSig(1:256));
    B(i) = 10*log10(max(abs(TTT).^2)/mean(abs(TTT).^2));
    
end

for j = 1:29
   C(j) = length(B(B>2.75+0.25*j)) ;
end

D = [3:0.25:10];
plot(D,log10(C/block));
test = C/(block);

%32sym
%[0.991900000000000,0.981100000000000,0.951200000000000,0.916100000000000,0.848100000000000,0.795400000000000,0.739200000000000,0.669100000000000,0.554300000000000,0.445700000000000,0.391100000000000,0.312600000000000,0.261500000000000,0.209300000000000,0.151500000000000,0.112300000000000,0.0801000000000000,0.0559000000000000,0.0391000000000000,0.0269000000000000,0.0164000000000000,0.00990000000000000,0.00740000000000000,0.00430000000000000,0.00280000000000000,0.00130000000000000,0.000400000000000000,0.000200000000000000,0.000200000000000000]

%16sym
%[0.999950000000000,0.999850000000000,0.998600000000000,0.994900000000000,0.986200000000000,0.970350000000000,0.938550000000000,0.898600000000000,0.833650000000000,0.745700000000000,0.671800000000000,0.583150000000000,0.494700000000000,0.397850000000000,0.317850000000000,0.242850000000000,0.186350000000000,0.137200000000000,0.0960500000000000,0.0691000000000000,0.0455500000000000,0.0293000000000000,0.0187500000000000,0.0117000000000000,0.00660000000000000,0.00400000000000000,0.00250000000000000,0.00145000000000000,0.000600000000000000]


%8sym
%[1,1,1,1,0.999900000000000,0.999200000000000,0.997450000000000,0.991000000000000,0.974200000000000,0.943950000000000,0.898700000000000,0.838250000000000,0.753550000000000,0.653900000000000,0.550900000000000,0.446700000000000,0.356100000000000,0.274250000000000,0.201750000000000,0.148850000000000,0.103700000000000,0.0694500000000000,0.0466000000000000,0.0322000000000000,0.0190000000000000,0.0107500000000000,0.00540000000000000,0.00270000000000000,0.00110000000000000]


%4sym
%[1,1,1,1,1,1,1,0.999850000000000,0.999500000000000,0.997200000000000,0.990300000000000,0.973650000000000,0.942500000000000,0.885900000000000,0.806700000000000,0.707550000000000,0.599050000000000,0.486500000000000,0.373650000000000,0.284600000000000,0.207200000000000,0.148100000000000,0.0987000000000000,0.0651500000000000,0.0413000000000000,0.0268500000000000,0.0157500000000000,0.00920000000000000,0.00580000000000000]

%2sym
%[1,1,1,1,1,1,1,1,1,1,1,0.999500000000000,0.997300000000000,0.988400000000000,0.966900000000000,0.921150000000000,0.846650000000000,0.746850000000000,0.622400000000000,0.495150000000000,0.378300000000000,0.276750000000000,0.194750000000000,0.130400000000000,0.0847500000000000,0.0546000000000000,0.0326500000000000,0.0191500000000000,0.0106000000000000]









