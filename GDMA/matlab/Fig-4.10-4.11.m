clc
clear

%{
x=[0 0 0 0 0.835308 0.771429 0.789354 0.780458 0.593341 0.804706 0.838037 0.830116 0.762936 0.793594 0.820707 0.797424 0.836386 0.772567 0.78492 0.710199 0 0 0 0 0.809645 0.760152 0.771795 0.787286 0.543135 0.808405 0.826506 0.79857 0.766061 0.786905 0.806008 0.801596 0.821847 0.804502 0.762774 0.70184 0 0 0 0 0.796651 0.782555 0.789222 0.790754 0.563482 0.808874 0.825123 0.818297 0.755896 0.839858 0.820253 0.814767 0.8375 0.782871 0.741587 0.673373 0 0 0 0 0.806533 0.762533 0.799743 0.770128 0.553637 0.810063 0.815668 0.8375 0.790168 0.812729 0.803594 0.788835 0.802974 0.787843 0.737037 0.68503 0 0 0 0 0.790262 0.752675 0.762424 0.802978 0.553459 0.8041 0.797483 0.823138 0.720348 0.81039 0.806373 0.786286 0.807971 0.782297 0.75 0.68446 0 0 0 0 0.8026 0.77662 0.748436 0.766298 0.531726 0.795314 0.783883 0.804718 0.748201 0.796186 0.788698 0.796069 0.793939 0.768868 0.724224 0.677707 0 0 0 0 0.805344 0.758294 0.747837 0.772727 0.541205 0.785455 0.80532 0.815759 0.761671 0.777011 0.802817 0.790989 0.796069 0.764268 0.75842 0.682927 0 0 0 0 0.789354 0.760563 0.766871 0.770686 0.503686 0.799523 0.771531 0.80445 0.743429 0.790398 0.760192 0.790668 0.787559 0.78375 0.743842 0.664649 0 0 0 0 0.805096 0.755319 0.7603 0.764848 0.521092 0.772831 0.811014 0.806228 0.727384 0.794781 0.820399 0.76583 0.788889 0.744654 0.740876 0.681761 0 0 0 0 0.783175 0.766344 0.74313 0.739726 0.518248 0.789847 0.794904 0.786335 0.72956 0.776138 0.77485 0.776207 0.798795 0.73747 0.74113 0.6787 0 0 0 0 0.782288 0.731995 0.721212 0.742515 0.501225 0.770047 0.807601 0.788294 0.72365 0.767726 0.79857 0.794012 0.783851 0.749409 0.71532 0.649289 0 0 0 0 0.791469 0.721886 0.752096 0.710627 0.492857 0.762284 0.77375 0.798042 0.73125 0.781542 0.75 0.768153 0.795637 0.751834 0.729114 0.643787 0 0 0 0 0.780987 0.749714 0.739977 0.732673 0.497543 0.780193 0.77205 0.756188 0.720245 0.768293 0.762022 0.772619 0.784933 0.74399 0.719116 0.65566 0 0 0 0 0.803571 0.718391 0.726291 0.74665 0.506329 0.780822 0.784946 0.766839 0.708804 0.750617 0.783175 0.757683 0.782558 0.716233 0.699292 0.669461 0 0 0 0 0.764706 0.709178 0.753247 0.726264 0.479191 0.764151 0.748775 0.751523 0.704327 0.759651 0.76775 0.730435 0.78773 0.702179 0.697904 0.605433 0 0 0 0 0.74763 0.699878 0.7475 0.709184 0.468565 0.710429 0.752727 0.768638 0.681818 0.769134 0.735053 0.724095 0.758993 0.740881 0.693827 0.63145 0 0 0 0 0.781665 0.692506 0.712346 0.732927 0.436209 0.756997 0.763505 0.748524 0.690051 0.72779 0.768692 0.74607 0.755528 0.721234 0.634204 0.617992 0 0 0 0 0.742268 0.706714 0.706378 0.701266 0.441748 0.754453 0.7575 0.746126 0.66005 0.742621 0.73913 0.737299 0.760499 0.691578 0.679901 0.600967 0 0 0 0 0.768204 0.718398 0.711491 0.697733 0.45433 0.748175 0.771804 0.733922 0.677146 0.715539 0.747266 0.755754 0.752911 0.701711 0.67209 0.639661 0 0 0 0 0.756919 0.703567 0.695018 0.723529 0.457688 0.708038 0.714286 0.730435 0.669127 0.711418 0.754854 0.717604 0.75 0.718398 0.667055 0.638889 0 0 0 0 0.731195 0.692491 0.671233 0.694146 0.458738 0.740157 0.736585 0.716837 0.654249 0.73138 0.728192 0.748821 0.755127 0.69697 0.669261 0.575412 0 0 0 0 0.749383 0.676829 0.67052 0.6956 0.423913 0.690821 0.70869 0.738971 0.62212 0.722151 0.747537 0.720742 0.746231 0.688107 0.640801 0.622865 0 0 0 0 0.729341 0.637736 0.673102 0.679487 0.421607 0.687573 0.719854 0.710337 0.601299 0.686967 0.732491 0.705811 0.693057 0.693649 0.672986 0.566321 0 0 0 0 0.729792 0.690621 0.644394 0.687345 0.444976 0.701314 0.731649 0.702051 0.649335 0.701235 0.712546 0.675472 0.739474 0.66161 0.65625 0.542821 0 0 0 0 0.709877 0.645199 0.64332 0.659367 0.423501 0.68615 0.669704 0.723731 0.604141 0.706107 0.678832 0.660401 0.689345 0.685012 0.631453 0.568884 0 0 0 0 0.732075 0.641844 0.629344 0.658537 0.399249 0.660606 0.686513 0.698178 0.613532 0.668782 0.665848 0.623226 0.679852 0.634232 0.646643 0.578947 0 0 0 0 0.703529 0.633735 0.645889 0.646857 0.351025 0.62963 0.696471 0.626582 0.554321 0.646214 0.665089 0.647572 0.662244 0.617047 0.630013 0.529851 0 0 0 0 0.695921 0.6 0.618715 0.644414 0.352624 0.646192 0.66625 0.631447 0.541409 0.615023 0.646772 0.618557 0.677536 0.602217 0.606641 0.52561 0 0 0 0 0.645244 0.587224 0.612946 0.606452 0.333755 0.634204 0.62303 0.596469 0.524374 0.574121 0.603113 0.614057 0.642766 0.609499 0.576873 0.54522 0 0 0 0 0.638783 0.55858 0.557743 0.566038 0.327945 0.576227 0.614518 0.598446 0.496947 0.58399 0.581977 0.562025 0.61165 0.578882 0.547051 0.493116 0.000312402 0 0 0 0.629771 0.531566 0.514654 0.534161 0.304688 0.554264 0.567503 0.546798 0.483395 0.547289 0.568182 0.541667 0.561626 0.531991 0.492696 0.461538 0 0 0 0 0.623656 0.527062 0.531407 0.506361 0.289538 0.543506 0.53494 0.536802 0.437824 0.527881 0.531613 0.487148 0.52375 0.476005 0.490637 0.446043 0 0 0 0 0.583942 0.441767 0.491706 0.477301 0.275904 0.517722 0.528485 0.502469 0.438931 0.496164 0.528822 0.503153 0.532567 0.487053 0.479268 0.422705 0 0 0 0 0.591022 0.502415 0.466135 0.461436 0.234694 0.489362 0.50828 0.478318 0.406061 0.501859 0.501809 0.465602 0.512228 0.484456 0.454658 0.424469 0 0 0 0 0.551425 0.413793 0.451733 0.475124 0.231631 0.5 0.466031 0.49875 0.389744 0.480888 0.478043 0.476776 0.513819 0.452632 0.427518 0.434343 0 0 0 0 0.547826 0.414449 0.457179 0.450721 0.224051 0.470437 0.510178 0.471939 0.386052 0.43617 0.457627 0.446384 0.498786 0.439153 0.426829 0.391927 0 0 0 0 0.586298 0.446727 0.425065 0.445963 0.200272 0.464646 0.474201 0.49563 0.335758 0.477041 0.487562 0.418605 0.478685 0.409449 0.434128 0.416883 0 0 0 0 0.513376 0.402868 0.451899 0.428571 0.220828 0.431472 0.455621 0.441687 0.377215 0.456853 0.423124 0.424354 0.451899 0.43073 0.439374 0.381182 0 0 0 0 0.516046 0.394095 0.393711 0.44878 0.221823 0.447917 0.435464 0.430993 0.367521 0.423858 0.496697 0.414894 0.471338 0.436214 0.4 0.397077 0.000320307 0 0 0 0.516403 0.386534 0.408505 0.415842 0.19821 0.404732 0.448276 0.414201 0.344486 0.386277 0.407035 0.398274 0.437423 0.365309 0.403823 0.372093 0 0 0 0 0.48977 0.374684 0.392547 0.378545 0.158157 0.393333 0.374693 0.425127 0.346056 0.422222 0.418699 0.392814 0.436893 0.376412 0.390402 0.367684 0 0 0 0 0.494282 0.383117 0.361314 0.345178 0.173403 0.396552 0.41375 0.419395 0.309202 0.381481 0.409511 0.369004 0.419643 0.358228 0.365662 0.316229 0 0 0 0 0.500623 0.337333 0.375484 0.360697 0.164948 0.357692 0.342432 0.384521 0.275591 0.343558 0.373037 0.352624 0.382701 0.378545 0.322304 0.325786 0 0 0 0 0.459158 0.353768 0.360837 0.343902 0.194271 0.359395 0.362069 0.374005 0.26933 0.358629 0.33867 0.352345 0.394737 0.31318 0.33967 0.296954 0 0 0 0 0.465736 0.298667 0.328321 0.314394 0.145655 0.365457 0.362135 0.344578 0.259552 0.342308 0.33724 0.317559 0.341722 0.344398 0.331226 0.284047 0 0 0 0 0.459279 0.295573 0.291328 0.277202 0.113307 0.29798 0.315217 0.346447 0.248724 0.328225 0.335435 0.302021 0.345499 0.33 0.322377 0.322759 0 0 0 0 0.453826 0.264295 0.282051 0.277778 0.119898 0.312827 0.29803 0.288336 0.23731 0.309609 0.315232 0.273919 0.326829 0.277051 0.287386 0.278272 0 0 0 0 0.421995 0.272406 0.240053 0.268844 0.0996441 0.270588 0.278351 0.306598 0.2 0.289003 0.282776 0.258355 0.284785 0.242344 0.283019 0.236111 0.0003125 0 0 0 0.369077 0.259259 0.246359 0.240051 0.100917 0.280702 0.286275 0.260377 0.193167 0.257353 0.258809 0.264493 0.276402 0.214854 0.227833 0.201743 0 0 0 0 0.379924 0.216602 0.241162 0.23385 0.0819876 0.259591 0.268232 0.233611 0.189422 0.216958 0.254282 0.240283 0.257516 0.211111 0.22561 0.239183 0 0 0 0 0.37931 0.214824 0.22665 0.211165 0.0886392 0.227273 0.237562 0.242823 0.175981 0.23544 0.238034 0.220493 0.229141 0.204082 0.215067 0.209893 0 0 0 0 0.327249 0.189189 0.169192 0.183079 0.0855019 0.227217 0.195596 0.203931 0.150442 0.205257 0.218509 0.191832 0.223392 0.196679 0.190535 0.200504 0 0 0 0 0.290482 0.196149 0.189255 0.183536 0.0562092 0.180285 0.185279 0.196517 0.159334 0.165652 0.155235 0.153061 0.190597 0.176617 0.170077 0.156212 0 0 0 0 0.276035 0.166008 0.143902 0.156658 0.0548628 0.167082 0.146402 0.150188 0.105474 0.136536 0.144192 0.153074 0.192893 0.148284 0.142292 0.131227 0 0 0 0 0.215686 0.126344 0.125 0.118471 0.0382716 0.117871 0.116037 0.15231 0.08125 0.122715 0.149813 0.126965 0.145386 0.112658 0.129606 0.117801 0 0 0 0 0.224359 0.1133 0.112455 0.112694 0.0280749 0.101759 0.117096 0.114213 0.0812183 0.105911 0.0992556 0.09601 0.117717 0.119647 0.076555 0.0946124 0 0 0 0 0.185554 0.0891892 0.0836601 0.0982143 0.0291616 0.0972763 0.0963139 0.086728 0.0490066 0.08948 0.091352 0.0826558 0.0790464 0.0591327 0.0749386 0.1075 0 0 0 0 0.181707 0.0609272 0.0750636 0.0762813 0.0160891 0.0652447 0.0651629 0.0604113 0.0312891 0.0556227 0.0641509 0.0573664 0.0665054 0.0679095 0.0648715 0.0640854 0 0 0 0 0.123077 0.0659062 0.0556274 0.0487805 0.0206186 0.0534826 0.0532544 0.0530565 0.0323415 0.0407359 0.043883 0.0406091 0.0521092 0.0460772 0.030303 0.04 0 0 0 0 0.106852 0.0280971 0.0431566 0.0336239 0.00738916 0.018315 0.0376135 0.0230863 0.0242424 0.0197531 0.0314389 0.020025 0.0218228 0.0188917 0.0290038 0.0153453 0 0 0 0 0.0442478 0.0154028 0.02125 0.013285 0.0060024 0.0202864 0.0152284 0.0220493 0.0113208 0.0156438 0.00617284 0.0121359 0.00887199 0.00789474 0.0188442 0.00921053 0 0 0 0 0.0176768 0.00532623 0.0097561 0.00636132 0.0025974 0.0049505 0.00256082 0.00580046 0.00383142 0.00642674 0.00630517 0.00238949 0.00369458 0.00366748 0.00262467 0];
figure;
plot(x);
y=[];
for i=1:1240
    if mod(i-1,20) < 4
        y(i) = x(i);
    else
        y(i) = mean(x(fix((i-1)/20)*20+5:fix((i-1)/20)*20+20));
    end
end


figure;
plot(y,'o');
xlabel('$\tau_2-\tau_1 $','interpreter','latex', 'fontsize', 18);
ylabel('Pr_{error}', 'fontsize', 15);
set(gca,'fontname','Times New Roman');
set(gcf,'position',[100, 100, 850, 600]);
grid on;

xx=[0 0 0 0 0.825829 0.805714 0.83239 0.81544 0.749108 0.829412 0.83681 0.803089 0.565584 0.736655 0.809343 0.796253 0.822955 0.730363 0.739184 0.691542 0.000299133 0 0 0 0.829949 0.77665 0.788462 0.789731 0.761847 0.803461 0.807229 0.818832 0.540606 0.778571 0.784731 0.767389 0.807542 0.725118 0.740876 0.680982 0 0 0 0 0.800239 0.796069 0.820359 0.811436 0.801693 0.822526 0.805419 0.791614 0.53066 0.761566 0.803797 0.761658 0.83625 0.71532 0.774038 0.680473 0 0 0 0 0.811558 0.800792 0.844673 0.794632 0.74476 0.833962 0.800691 0.7925 0.564748 0.790698 0.754814 0.717233 0.819083 0.730632 0.748148 0.627545 0 0 0 0 0.811486 0.804994 0.833939 0.786942 0.74717 0.826879 0.802059 0.828457 0.551687 0.805195 0.781863 0.787429 0.799517 0.699761 0.719543 0.666667 0 0 0 0 0.817967 0.814815 0.804756 0.804428 0.766497 0.792848 0.808303 0.794233 0.581535 0.784267 0.773956 0.765356 0.785455 0.714623 0.732919 0.677707 0 0 0 0 0.801527 0.809242 0.807169 0.813268 0.729397 0.793939 0.834341 0.80533 0.534398 0.786207 0.771127 0.729662 0.79484 0.719603 0.736353 0.687573 0 0 0 0 0.819932 0.761737 0.795092 0.788416 0.755528 0.804296 0.809809 0.806792 0.540676 0.761124 0.782974 0.788146 0.786385 0.71875 0.708128 0.681598 0 0 0 0 0.806369 0.780142 0.790262 0.755152 0.763027 0.783105 0.801001 0.792388 0.52934 0.762752 0.77051 0.778973 0.761728 0.677987 0.710462 0.638994 0 0 0 0 0.822275 0.791768 0.804062 0.795766 0.761557 0.799292 0.817834 0.780124 0.533333 0.767528 0.750898 0.760895 0.759036 0.680191 0.721419 0.681107 0 0 0 0 0.815498 0.780401 0.786667 0.789222 0.726716 0.813679 0.826603 0.805729 0.533419 0.784841 0.750894 0.707784 0.770186 0.693853 0.73462 0.643365 0 0 0 0 0.828199 0.764208 0.794012 0.777209 0.741667 0.796813 0.7775 0.793146 0.52375 0.772196 0.757282 0.769427 0.792193 0.660147 0.702532 0.671006 0 0 0 0 0.801444 0.768 0.802978 0.783416 0.750614 0.822464 0.801833 0.803218 0.489571 0.747561 0.754624 0.722619 0.783718 0.68149 0.729519 0.602594 0 0 0 0 0.786905 0.772414 0.781513 0.758831 0.759494 0.795766 0.783751 0.792746 0.485327 0.733333 0.735782 0.719858 0.784884 0.672862 0.665094 0.651497 0 0 0 0 0.804348 0.781883 0.792208 0.786683 0.730083 0.808962 0.785539 0.771011 0.503606 0.739726 0.736462 0.734161 0.77546 0.654964 0.695438 0.614489 0 0 0 0 0.792654 0.744836 0.78125 0.762755 0.730724 0.797546 0.761212 0.754499 0.509324 0.736512 0.752638 0.739076 0.76259 0.709434 0.680247 0.579853 0 0 0 0 0.793727 0.777778 0.797531 0.754878 0.710814 0.800254 0.769508 0.753247 0.498724 0.741458 0.744159 0.740024 0.767813 0.660735 0.678147 0.627119 0 0 0 0 0.805412 0.750294 0.772563 0.76962 0.699029 0.778626 0.755 0.762813 0.478908 0.724911 0.729193 0.697646 0.750284 0.647687 0.668734 0.609432 0 0 0 0 0.773058 0.77597 0.766504 0.778338 0.730724 0.785888 0.772999 0.774275 0.465538 0.706767 0.735115 0.695652 0.760673 0.635697 0.667084 0.598549 0 0 0 0 0.772563 0.763838 0.766707 0.731765 0.687723 0.774232 0.754098 0.771739 0.496925 0.723965 0.716019 0.721271 0.737028 0.643304 0.668219 0.593434 0 0 0 0 0.740044 0.769964 0.809465 0.763441 0.729369 0.744657 0.746341 0.747449 0.44936 0.717949 0.733249 0.686321 0.763571 0.628788 0.661479 0.607098 0 0 0 0 0.775309 0.745122 0.745665 0.739596 0.693237 0.764493 0.744186 0.727941 0.450461 0.725992 0.725369 0.68482 0.731156 0.637136 0.633292 0.60841 0.000311333 0 0 0 0.782036 0.722013 0.773488 0.750583 0.674572 0.788618 0.750305 0.766827 0.397403 0.730816 0.727899 0.68523 0.72838 0.603985 0.650474 0.575548 0 0 0 0 0.772517 0.72229 0.771234 0.746898 0.650718 0.74552 0.748496 0.752714 0.446191 0.688889 0.705238 0.683019 0.730263 0.609102 0.66125 0.585642 0 0 0 0 0.78642 0.708431 0.76524 0.72871 0.691554 0.761118 0.766515 0.710744 0.449452 0.706107 0.718978 0.672932 0.727856 0.617096 0.638655 0.561758 0 0 0 0 0.766038 0.71513 0.720721 0.744483 0.652065 0.761212 0.73633 0.732346 0.425459 0.711929 0.700246 0.663226 0.721879 0.602579 0.644287 0.568421 0 0 0 0 0.725882 0.715663 0.706897 0.722286 0.671894 0.75679 0.737647 0.697468 0.428395 0.689295 0.672189 0.66127 0.716526 0.605042 0.631307 0.550995 0 0 0 0 0.760198 0.72638 0.740223 0.735695 0.647376 0.727273 0.7575 0.727044 0.425216 0.70892 0.685749 0.617268 0.718599 0.567734 0.605364 0.534146 0 0 0 0 0.741645 0.702703 0.713342 0.701935 0.647282 0.729216 0.744242 0.723834 0.399209 0.665829 0.687419 0.639951 0.713188 0.576517 0.60184 0.5 0 0 0 0 0.730038 0.72071 0.708661 0.693396 0.643187 0.713178 0.755945 0.700777 0.40293 0.699475 0.652065 0.637975 0.719834 0.575155 0.621079 0.550688 0 0 0 0 0.740458 0.705808 0.724502 0.737888 0.617188 0.762274 0.707288 0.694581 0.362854 0.660782 0.65107 0.648284 0.681067 0.582938 0.585657 0.513241 0 0 0 0 0.725209 0.675258 0.69598 0.673028 0.647202 0.738966 0.721687 0.709391 0.398964 0.662949 0.620645 0.615667 0.66 0.525292 0.595506 0.497602 0 0 0 0 0.723844 0.70415 0.699052 0.69816 0.596386 0.694937 0.728485 0.696296 0.372774 0.663683 0.651629 0.626734 0.687101 0.53021 0.60122 0.51087 0 0 0 0 0.700748 0.687198 0.682603 0.69016 0.607143 0.690864 0.71465 0.683311 0.344242 0.636927 0.635706 0.632678 0.66712 0.534974 0.567702 0.521848 0 0 0 0 0.684015 0.676884 0.705446 0.652985 0.651308 0.686104 0.676996 0.66875 0.35 0.635018 0.634881 0.590164 0.677136 0.521053 0.54914 0.488636 0 0 0 0 0.693168 0.637516 0.687657 0.658654 0.620253 0.678663 0.693384 0.681122 0.354919 0.62234 0.650587 0.599751 0.646845 0.521164 0.556098 0.49349 0 0 0 0 0.685112 0.677792 0.673127 0.645963 0.589918 0.67803 0.681818 0.67166 0.374545 0.626276 0.620647 0.608527 0.676005 0.53937 0.559598 0.480519 0 0 0 0 0.712102 0.654498 0.691139 0.662216 0.614806 0.687817 0.671006 0.663772 0.321519 0.604061 0.602706 0.590406 0.68481 0.511335 0.556714 0.482509 0 0 0 0 0.65982 0.648267 0.664151 0.660976 0.539568 0.690104 0.645356 0.679177 0.339438 0.620558 0.595773 0.591755 0.671338 0.499314 0.512195 0.464068 0 0 0 0 0.64034 0.654613 0.670103 0.653465 0.586957 0.674969 0.651034 0.63432 0.332094 0.609911 0.592965 0.572133 0.612144 0.496715 0.524492 0.412145 0 0 0 0 0.667519 0.650633 0.689441 0.641184 0.607721 0.658667 0.670762 0.642132 0.306616 0.596296 0.589431 0.565269 0.626214 0.46926 0.55642 0.463104 0 0 0 0 0.677255 0.58961 0.625304 0.640863 0.590613 0.637931 0.6575 0.65995 0.27362 0.612346 0.5786 0.579336 0.642857 0.491139 0.526868 0.461814 0 0 0 0 0.641345 0.618667 0.636129 0.616915 0.516753 0.628205 0.640199 0.624079 0.276903 0.586503 0.554974 0.558546 0.592417 0.452528 0.520833 0.422642 0 0 0 0 0.644802 0.60281 0.624384 0.589024 0.555417 0.67087 0.653941 0.616711 0.266753 0.585067 0.584975 0.546261 0.606516 0.455865 0.515843 0.387056 0 0 0 0 0.621827 0.58 0.616541 0.60101 0.541004 0.640801 0.625159 0.598795 0.238472 0.596154 0.583333 0.52802 0.627815 0.467497 0.489254 0.383917 0 0 0 0 0.616822 0.574219 0.644986 0.591969 0.519104 0.612374 0.585749 0.610406 0.289541 0.581098 0.556116 0.525565 0.593674 0.41625 0.490518 0.376552 0 0 0 0 0.604222 0.580686 0.567949 0.577295 0.514031 0.585079 0.597291 0.533421 0.279188 0.498221 0.541722 0.536042 0.559756 0.391201 0.448635 0.368488 0 0 0 0 0.584399 0.551887 0.558355 0.541457 0.485172 0.602614 0.581186 0.554981 0.225641 0.51023 0.482005 0.506427 0.582575 0.434088 0.445283 0.352273 0 0 0 0 0.617207 0.555556 0.557039 0.539153 0.494102 0.607769 0.583007 0.545912 0.220762 0.511029 0.496962 0.519324 0.563233 0.395225 0.445813 0.356164 0 0 0 0 0.593393 0.553826 0.546717 0.55168 0.465839 0.576726 0.552534 0.532777 0.210332 0.5 0.490119 0.473498 0.532026 0.395062 0.404878 0.344952 0 0 0 0 0.560664 0.518844 0.526775 0.533981 0.491885 0.561869 0.537313 0.523923 0.217598 0.506815 0.48771 0.448768 0.530511 0.34934 0.441069 0.356952 0 0 0 0 0.522816 0.487773 0.551768 0.540915 0.427509 0.498177 0.527202 0.511057 0.219975 0.465582 0.457584 0.438119 0.498246 0.367816 0.383562 0.311475 0 0 0 0 0.530284 0.471721 0.496947 0.477733 0.435294 0.522698 0.48731 0.486318 0.180737 0.466504 0.465704 0.414541 0.508259 0.356965 0.398977 0.345633 0 0 0 0 0.486826 0.479578 0.5 0.471279 0.392768 0.468828 0.466501 0.480601 0.182911 0.470291 0.432577 0.422836 0.47335 0.349265 0.40448 0.296476 0 0 0 0 0.535539 0.448925 0.46 0.430573 0.349383 0.463878 0.451108 0.444444 0.17125 0.430809 0.420724 0.383313 0.484197 0.336709 0.365947 0.265707 0 0 0 0 0.485897 0.418719 0.467956 0.431347 0.391711 0.443467 0.419204 0.423858 0.151015 0.394089 0.388337 0.342893 0.461356 0.311083 0.358852 0.274639 0 0 0 0 0.454545 0.387838 0.411765 0.397959 0.36452 0.420233 0.404281 0.381078 0.143046 0.337364 0.353228 0.352304 0.431619 0.29435 0.357494 0.2475 0 0 0 0 0.414634 0.353642 0.394402 0.352801 0.268564 0.363864 0.37594 0.3509 0.118899 0.315599 0.316981 0.303781 0.392987 0.250333 0.323133 0.245661 0 0 0 0 0.384615 0.316857 0.32859 0.311653 0.259021 0.325871 0.35503 0.322953 0.107374 0.296978 0.280585 0.280457 0.389578 0.272727 0.269091 0.228 0 0 0 0 0.346109 0.264368 0.307028 0.259029 0.215517 0.278388 0.278859 0.27096 0.111515 0.230864 0.275695 0.245307 0.327343 0.210327 0.264817 0.20844 0 0 0 0 0.298357 0.234597 0.25875 0.229469 0.160864 0.207637 0.225888 0.184176 0.0742138 0.20698 0.176543 0.179612 0.272497 0.180263 0.198492 0.143421 0 0 0 0 0.209596 0.17976 0.191463 0.147583 0.0831169 0.190594 0.144686 0.163573 0.0472542 0.120823 0.100883 0.139785 0.19335 0.0831296 0.148294 0.0935525];
figure;
plot(xx);
yy=[];
for i=1:1240
    if mod(i-1,20) < 4
        yy(i) = xx(i);
    else
        yy(i) = mean(xx(fix((i-1)/20)*20+5:fix((i-1)/20)*20+20));
    end
end


figure;
plot(yy,'o');

xlabel('$\tau_2-\tau_1 $','interpreter','latex', 'fontsize', 18);
ylabel('Pr_{error}', 'fontsize', 15);
set(gca,'fontname','Times New Roman');
set(gcf,'position',[100, 100, 850, 600]);
grid on;
%}


% 0-16 dB
U2_collision_time_csi=[6.290000e-02, 3.025000e-01, 5.596000e-01, 6.549000e-01, 6.710500e-01];
U2_collision_es_csi=[6.285000e-02, 2.937500e-01, 5.315000e-01, 6.042677e-01, 6.142677e-01];
U2_collision_es_es=[3.615000e-02, 2.150000e-01, 4.459500e-01, 5.621500e-01, 5.883000e-01];
U2_collision_time_csi_=[5.995000e-02, 1.649000e-01, 3.044000e-01, 4.485000e-01, 5.612000e-01, 6.254500e-01, 6.573500e-01, 6.709000e-01, 6.667500e-01];
%U2_collision_es_csi_=[5.975000e-02, 1.544000e-01, 2.927000e-01, 4.294500e-01, 5.303000e-01, 5.867500e-01, 6.185000e-01, 6.334500e-01, 6.282500e-01];
U2_collision_es_csi_=[3.826923e-02, 1.055267e-01, 2.131393e-01, 3.401504e-01, 4.350356e-01, 4.970328e-01, 5.447014e-01, 5.589999e-01, 5.623195e-01];
%U2_collision_es_es_=[3.615000e-02, 1.038500e-01, 2.165500e-01, 3.377500e-01, 4.415000e-01, 5.184500e-01, 5.667000e-01, 5.825500e-01, 5.848000e-01];
U2_collision_es_es_=[1.960400e-02, 7.174680e-02, 1.550355e-01, 2.548800e-01, 3.410199e-01, 4.150193e-01, 4.642704e-01, 4.944905e-01, 5.025863e-01];
%U2_collision_es_es_cluster=[3.820000e-02, 1.070000e-01, 2.318000e-01, 3.553500e-01, 4.664500e-01, 5.392000e-01, 5.835000e-01, 5.981500e-01, 6.076000e-01];
U2_collision_es_es_cluster=[2.247850e-02, 7.329503e-02, 1.544640e-01, 2.623543e-01, 3.625239e-01, 4.322130e-01, 4.815448e-01, 5.035736e-01, 5.114791e-01];
U2_mse_first=[9.255703e-02,7.099457e-02,5.309769e-02,4.009568e-02,3.129698e-02,2.615207e-02,2.336730e-02,2.120403e-02,1.899247e-02];
U2_mse_second=[8.472295e-02,5.909511e-02,3.795611e-02,2.497607e-02,1.652800e-02,1.268081e-02,1.061519e-02,8.856392e-03,7.007132e-03];

figure;
plot([0:2:16], U2_collision_time_csi_,'-*', 'MarkerSize', 10, 'linewidth', 1,'color',[0 0 0]); hold on;
plot([0:2:16], U2_collision_es_csi_,'-s', 'MarkerSize', 10, 'linewidth', 1,'color',[1 0 0]);
plot([0:2:16], U2_collision_es_es_,'-d', 'MarkerSize', 10, 'linewidth', 1,'color',[0 0 1]);
plot([0:2:16], U2_collision_es_es_cluster,'-<', 'MarkerSize', 10, 'linewidth', 1,'color',[0.2 0.5 1]);

xlabel('SNR(dB)','interpreter','latex', 'fontsize', 18);
ylabel('Throughput', 'fontsize', 18);
set(gca,'fontname','Times New Roman');
set(gcf,'position',[100, 100, 850, 600]);
leg=legend('Perfect Time; Perfect CSI','Estimated Time; Perfect CSI','Estimated Time; First Channel Estimation','Estimated Time; Second Channel Estimation','Location','southeast');
set(leg, 'fontsize', 15);
grid on;

% 4-20 dB

U2_perfecttime_perfectcsi=[3.082692e-01, 4.414059e-01, 5.509449e-01, 6.251375e-01, 6.821818e-01, 7.108789e-01, 7.259274e-01, 7.377262e-01, 7.467753e-01];
U2_estimatetime_perfectcsi=[2.034797e-01, 3.153685e-01, 4.182582e-01, 4.933507e-01, 5.490451e-01, 5.768423e-01, 5.929907e-01, 6.058894e-01, 6.170883e-01];
U2_perfecttime_estimatecsi_1=[2.594741e-01, 3.938606e-01, 5.162984e-01, 5.923908e-01, 6.449855e-01, 6.823818e-01, 7.007299e-01, 7.181282e-01, 7.240776e-01];
U2_perfecttime_estimatecsi_2=[2.823718e-01, 4.229577e-01, 5.366463e-01, 6.213879e-01, 6.725327e-01, 7.084792e-01, 7.188781e-01, 7.329267e-01, 7.405259e-01];
U2_estimatetime_estimatecsi_1=[1.760824e-01, 2.849215e-01, 4.055094e-01, 4.855514e-01, 5.460454e-01, 5.817918e-01, 6.042896e-01, 6.160374e-01, 6.285371e-01];
U2_estimatetime_estimatecsi_2=[1.863814e-01, 3.154185e-01, 4.201080e-01, 5.081492e-01, 5.644436e-01, 5.932407e-01, 6.217878e-01, 6.319872e-01, 6.428357e-01];

U2_perfecttime_estimatecsi_1_doppler=[1.899810e-01, 2.994701e-01, 3.955104e-01, 4.707029e-01, 5.183982e-01, 5.588441e-01, 5.791921e-01, 5.892911e-01, 6.005399e-01];
U2_perfecttime_estimatecsi_2_doppler=[1.897810e-01, 3.011699e-01, 4.061594e-01, 4.808519e-01, 5.310469e-01, 5.651435e-01, 5.842416e-01, 5.950905e-01, 6.044396e-01];
figure;
plot([4:2:20], U2_perfecttime_perfectcsi,'-+', 'MarkerSize', 10, 'linewidth', 1,'color',[0 0 0]); hold on;
plot([4:2:20], U2_perfecttime_estimatecsi_1,'-*', 'MarkerSize', 10, 'linewidth', 1,'color',[0 0.5 1]);
plot([4:2:20], U2_perfecttime_estimatecsi_2,'-s', 'MarkerSize', 10, 'linewidth', 1,'color',[1 0.5 0]);
plot([4:2:20], U2_estimatetime_estimatecsi_1,'-o', 'MarkerSize', 10, 'linewidth', 1,'color',[0 0 1]);
plot([4:2:20], U2_estimatetime_estimatecsi_2,'-<', 'MarkerSize', 10, 'linewidth', 1,'color',[1 0 0]);

xlabel('SNR(dB)','interpreter','latex', 'fontsize', 18);
ylabel('Success Rate', 'fontsize', 18);
set(gca,'fontname','Times New Roman');
set(gcf,'position',[100, 100, 850, 600]);
leg=legend('Perfect Time; Perfect CSI','Perfect Time; First Channel Estimation','Perfect Time; Second Channel Estimation','Estimated Time; First Channel Estimation','Estimated Time; Second Channel Estimation','Location','southeast');
set(leg, 'fontsize', 15);
grid on;

figure;
plot([4:2:20], U2_perfecttime_perfectcsi,'-+', 'MarkerSize', 10, 'linewidth', 1,'color',[0 0 0]); hold on;
plot([4:2:20], U2_perfecttime_estimatecsi_1,'-*', 'MarkerSize', 10, 'linewidth', 1,'color',[0 0 1]);
plot([4:2:20], U2_perfecttime_estimatecsi_2,'-s', 'MarkerSize', 10, 'linewidth', 1,'color',[0.2 0.5 1]);
plot([4:2:20], U2_perfecttime_estimatecsi_1_doppler,'-o', 'MarkerSize', 10, 'linewidth', 1,'color',[1 0 0]);
plot([4:2:20], U2_perfecttime_estimatecsi_2_doppler,'-<', 'MarkerSize', 10, 'linewidth', 1,'color',[1 0.5 0.2]);
xlabel('SNR(dB)','interpreter','latex', 'fontsize', 18);
ylabel('Success Rate', 'fontsize', 18);
set(gca,'fontname','Times New Roman');
set(gcf,'position',[100, 100, 850, 600]);
leg=legend('Perfect Time; Perfect CSI','Perfect Time; First Channel Estimation','Perfect Time; Second Channel Estimation','Perfect Time; First Channel Estimation; Doppler channel','Perfect Time; Second Channel Estimation; Doppler channel','Location','southeast');
set(leg, 'fontsize', 15);
grid on;
%{
figure;
semilogy([0:2:16], U2_mse_first,'-*', 'MarkerSize', 10, 'linewidth', 1,'color',[0 0 0]); hold on;
semilogy([0:2:16], U2_mse_second,'-s', 'MarkerSize', 10, 'linewidth', 1,'color',[1 0 0]);
xlabel('SNR(dB)','interpreter','latex', 'fontsize', 18);
ylabel('MSE', 'fontsize', 18);
set(gca,'fontname','Times New Roman');
set(gcf,'position',[100, 100, 850, 600]);
leg=legend('Estimated Time; First Channel Estimation','Estimated Time; Second Channel Estimation','Location','southwest');
set(leg, 'fontsize', 15);
grid on;
%}
U1_perfecttime_perfectcsi_bler=[5.214479e-01,2.915708e-01,1.286871e-01,4.970455e-02,1.429081e-02,3.560000e-03,6.900000e-04,1.000000e-04,3.000000e-05];
U1_perfecttime_estimatecsi_1_bler=[5.729427e-01,3.470653e-01,1.703830e-01,6.396575e-02,2.181541e-02,5.450000e-03,1.280000e-03,3.400000e-04,0];
U1_perfecttime_estimatecsi_2_bler=[5.564444e-01,3.207679e-01,1.538846e-01,5.791819e-02,1.763069e-02,5.000000e-03,1.200000e-03,2.600000e-04,0];
U1_estimatetime_estimatecsi_1_bler=[6.765323e-01,4.497550e-01,2.544746e-01,1.279872e-01,6.397392e-02,3.431843e-02,2.523572e-02, 1.958791e-02, 1.11804e-02];
U1_estimatetime_estimatecsi_2_bler=[ 6.415358e-01,4.332567e-01,2.456754e-01,1.223878e-01,6.279799e-02,3.628915e-02,2.534113e-02,1.828804e-02, 1.128804e-02];
U1_perfecttime_estimatecsi_1_mse=[3.951051e-02,2.505451e-02,1.570822e-02,9.915858e-03,6.273872e-03,3.944620e-03,2.494657e-03,1.577176e-03,9.963565e-04];
U1_perfecttime_estimatecsi_2_mse=[1.734369e-02,9.023117e-03,4.839729e-03,2.681361e-03,1.535563e-03,9.013293e-04,5.431179e-04,3.302354e-04,2.040916e-04];

U1_perfecttime_dopplerestimatecsi_1_bler=[6.632337e-01,4.618538e-01,3.115688e-01,2.045795e-01,1.430857e-01, 1.059894e-01,8.121045e-02,7.277883e-02,6.693414e-02];
U1_perfecttime_dopplerestimatecsi_2_bler=[6.369363e-01,3.929607e-01,1.937806e-01,7.003428e-02, 2.095545e-02,4.450000e-03,8.581849e-04,0,0];
U1_estimatetime_dopplerestimatecsi_1_bler=[7.418258e-01,5.446455e-01,3.818618e-01,2.576742e-01,1.707829e-01,1.222878e-01,1.025897e-01,8.766859e-02,8.061529e-02];
U1_estimatetime_dopplerestimatecsi_2_bler=[7.168283e-01,4.903510e-01,2.780722e-01,1.362864e-01,6.770375e-02,3.657155e-02,2.485783e-02,2.077112e-02,1.708659e-02];

snr = 4:2:20; % in dB
snr = 10.^(snr/10); % linear
crlb= zeros(1,length(snr));

for i = 1:length(snr)
    crlb(i) = 1/(50*snr(i));
end

figure;
semilogy([4:2:20], crlb,'-<', 'MarkerSize', 10, 'linewidth', 1,'color',[0 0 0]);hold on;
semilogy([4:2:20], U1_perfecttime_estimatecsi_1_mse,'-*', 'MarkerSize', 10, 'linewidth', 1,'color',[0 0 1]); 
semilogy([4:2:20], U1_perfecttime_estimatecsi_2_mse,'-s', 'MarkerSize', 10, 'linewidth', 1,'color',[1 0 0]);


xlabel('SNR(dB)','interpreter','latex', 'fontsize', 18);
ylabel('MSE', 'fontsize', 18);
set(gca,'fontname','Times New Roman');
set(gcf,'position',[100, 100, 850, 600]);
leg=legend('CRLB','First Channel Estimation', 'Second Channel Estimation','Location','southeast');
set(leg, 'fontsize', 15);
grid on;

figure;
semilogy([4:2:20], 1 - U1_perfecttime_perfectcsi_bler,'-+', 'MarkerSize', 10, 'linewidth', 1,'color',[0 0 0]); hold on;
semilogy([4:2:20], 1 - U1_perfecttime_estimatecsi_1_bler,'-*', 'MarkerSize', 10, 'linewidth', 1,'color',[0 0.5 1]); 
semilogy([4:2:20], 1 - U1_perfecttime_estimatecsi_2_bler,'-s', 'MarkerSize', 10, 'linewidth', 1,'color',[1 0.5 0]);
semilogy([4:2:20], 1 - U1_estimatetime_estimatecsi_1_bler,'-o', 'MarkerSize', 10, 'linewidth', 1,'color',[0 0 1]);
semilogy([4:2:20], 1 - U1_estimatetime_estimatecsi_2_bler,'-<', 'MarkerSize', 10, 'linewidth', 1,'color',[1 0 0]);

xlabel('SNR(dB)','interpreter','latex', 'fontsize', 18);
ylabel('Success Rate', 'fontsize', 18);
set(gca,'fontname','Times New Roman');
set(gcf,'position',[100, 100, 850, 600]);
leg=legend('Perfect Time; Perfect CSI','Perfect Time; First Channel Estimation','Perfect Time; Second Channel Estimation','Estimated Time; First Channel Estimation','Estimated Time; Second Channel Estimation','Location','southeast');
set(leg, 'fontsize', 15);
grid on;

figure;
semilogy([4:2:20], U1_perfecttime_perfectcsi_bler,'-+', 'MarkerSize', 10, 'linewidth', 1,'color',[0 0 0]); hold on;
semilogy([4:2:20], U1_perfecttime_estimatecsi_1_bler,'-*', 'MarkerSize', 10, 'linewidth', 1,'color',[0 0.5 1]); 
semilogy([4:2:20], U1_perfecttime_estimatecsi_2_bler,'-s', 'MarkerSize', 10, 'linewidth', 1,'color',[1 0.5 0]);
semilogy([4:2:20], U1_estimatetime_estimatecsi_1_bler,'-o', 'MarkerSize', 10, 'linewidth', 1,'color',[0 0 1]);
semilogy([4:2:20], U1_estimatetime_estimatecsi_2_bler,'-<', 'MarkerSize', 10, 'linewidth', 1,'color',[1 0 0]);

xlabel('SNR(dB)','interpreter','latex', 'fontsize', 18);
ylabel('Bler', 'fontsize', 18);
set(gca,'fontname','Times New Roman');
set(gcf,'position',[100, 100, 850, 600]);
leg=legend('Perfect Time; Perfect CSI','Perfect Time; First Channel Estimation','Perfect Time; Second Channel Estimation','Estimated Time; First Channel Estimation','Estimated Time; Second Channel Estimation','Location','southeast');
set(leg, 'fontsize', 15);
grid on;

